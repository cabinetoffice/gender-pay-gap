@using GenderPayGap.Core.Helpers
@using GenderPayGap.WebUI.Helpers
@using GenderPayGap.WebUI.Models.Shared
@using GenderPayGap.WebUI.Models.Viewing.Download
@model List<GenderPayGap.WebUI.Models.Viewing.Download.DownloadCsvFile>

@{
    ViewBag.Title = "Download gender pay gap data - Gender pay gap service";
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

        <h1 class="govuk-heading-xl govuk-!-margin-bottom-6">
            Download gender pay gap data
        </h1>
        <p class="govuk-body govuk-!-margin-bottom-1">
            You can download gender pay gap data for:
        </p>
        <ul class="govuk-list govuk-list--bullet">
            <li>a specific employer or sector</li>
            <li>all employers for each reporting year</li>
        </ul>
        
        <h2 class="govuk-heading-m govuk-!-padding-top-5">
            Download data for a specific employer or sector
        </h2>
        <p class="govuk-body">
            <a href="@Url.Action("SearchPage", "Search")"
               class="govuk-link">
                Search by employer name or sector</a>
            to download specific data.
            You can then select ‘Download data (CSV)’ on the
            <a href="@Url.Action("CompareEmployersNoYear", "CompareEmployers")"
               class="govuk-link">
                employer comparison</a>
            page.
        </p>
        
        <h2 class="govuk-heading-m govuk-!-padding-top-5">
            Download all data by reporting year
        </h2>
        <p class="govuk-body">
            @{
                int latestReportingYear = ReportingYearsHelper.GetTheMostRecentCompletedReportingYear();
            }
            The most recent year for which the reporting deadlines have passed is
            @(ReportingYearsHelper.FormatYearAsReportingPeriodLongFormat(latestReportingYear)).
        </p>

        <ul class="govuk-list govuk-list--bullet">
            @foreach (DownloadCsvFile downloadCsvFile in Model)
            {
                <li>
                    @if (downloadCsvFile.FileIsAvailable)
                    {
                        string fileSizeText = downloadCsvFile.FileSize.HasValue ? $"{DownloadHelper.GetFormattedFileSize(downloadCsvFile.FileSize.Value)} " : "";
                        
                        <a href="@Url.Action("DownloadData", "Download", new {year = downloadCsvFile.ReportingYear})"
                           class="govuk-link">
                            <span class="govuk-visually-hidden">Download gender pay gap data for</span>
                            Reporting year
                            @(ReportingYearsHelper.FormatYearAsReportingPeriodLongFormat(downloadCsvFile.ReportingYear))
                            (@(fileSizeText)CSV file)
                        </a>
                    }
                    else
                    {
                        <span>
                            Reporting year
                            @(ReportingYearsHelper.FormatYearAsReportingPeriodLongFormat(downloadCsvFile.ReportingYear))
                            (no CSV file available)
                        </span>
                    }
                </li>
            }
        </ul>

        <h3 class="govuk-heading-m govuk-!-padding-top-5">
            Glossary: columns in the data files
        </h3>
        <p class="govuk-body">
            Each data file contains the following columns.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘EmployerName’
        </h4>
        <p class="govuk-body">
            The name of the employer when they reported their data.
            Taken from Companies House (private and voluntary sector), or entered by public sector employers on the gender pay gap service.
        </p>
        
        
        <h4 class="govuk-heading-s">
            ‘Employer ID’
        </h4>
        <p class="govuk-body">
            Unique number generated by the gender pay gap service for each employer.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘Address’ and ‘PostCode’
        </h4>
        <p class="govuk-body">
            Current registered address and postcode of the employer.
            Taken from Companies House (private and voluntary sector), or entered by public sector employers on the gender pay gap service.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘CompanyNumber’
        </h4>
        <p class="govuk-body">
            Company number of the employer as listed on Companies House.
            Private and voluntary sectors only.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘SicCodes’
        </h4>
        <p class="govuk-body">
            The SIC codes that describe the sectors each employer operated in when they reported their data.
            Taken from Companies House (private and voluntary sector), or entered by public sector employers on the gender pay gap service.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘DiffMeanHourlyPercent’ and ‘DiffMedianHourlyPercent’
        </h4>
        <p class="govuk-body">
            The mean (average) and median percentage differences between the hourly pay of men and women.
            A positive percentage means men’s hourly pay is higher than women’s.
            A negative percentage means women’s pay is higher.
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘DiffMeanBonusPercent’ and ‘DiffMedianBonusPercent’
        </h4>
        <p class="govuk-body">
            The mean (average) and median percentage differences between the bonus pay of men and women.
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘MaleBonusPercent’ and ‘FemaleBonusPercent’
        </h4>
        <p class="govuk-body">
            The percentage of men and women who were paid a bonus in the reporting year.
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘MaleLowerQuartile’ and ‘FemaleLowerQuartile’
        </h4>
        <p class="govuk-body">
            The percentage of men and women in the lower hourly pay quarter (lowest paid).
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘MaleLowerMiddleQuartile’ and ‘FemaleLowerMiddleQuartile’
        </h4>
        <p class="govuk-body">
            The percentage of men and women in the lower middle hourly pay quarter.
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘MaleUpperMiddleQuartile’ and ‘FemaleUpperMiddleQuartile’
        </h4>
        <p class="govuk-body">
            The percentage of men and women in the upper middle hourly pay quarter.
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘MaleTopQuartile’ and ‘FemaleTopQuartile’
        </h4>
        <p class="govuk-body">
            The percentage of men and women in the upper hourly pay quarter (highest paid).
            Employers include this when they submit their gender pay gap data.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘CompanyLinkToGPGInfo’
        </h4>
        <p class="govuk-body">
            Link to the ‘written statement’ published by employers, with more information about their gender pay gap.
            Private and voluntary sectors only.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘ResponsiblePerson’
        </h4>
        <p class="govuk-body">
            Name of the person confirming that the published gender pay gap information is accurate.
            Private and voluntary sectors only.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘EmployerSize’
        </h4>
        <p class="govuk-body govuk-!-margin-bottom-2">
            Number of employees employed by an employer.
            Selected by employers from the following options:
        </p>
        <ul class="govuk-list govuk-list--bullet">
            <li>less than 250</li>
            <li>250 to 499</li>
            <li>500 to 999</li>
            <li>1,000 to 4,999</li>
            <li>5,000 to 19,999</li>
            <li>20,000 or more</li>
        </ul>
        
        <h4 class="govuk-heading-s">
            ‘CurrentName’
        </h4>
        <p class="govuk-body">
            The employer’s current name.
            Taken from Companies House (private and voluntary sector), or entered by public sector employers on the gender pay gap service.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘SubmittedAfterTheDeadline’
        </h4>
        <p class="govuk-body">
            Shows whether employers submitted their gender pay gap data by the relevant deadline (‘FALSE’) or after the deadline (‘TRUE’).
            If an employer edits their figures after submitting them, they are marked as late if they do this after the deadline.
            Generated by the gender pay gap service.
        </p>
        
        <h4 class="govuk-heading-s">
            ‘DueDate’ and ‘DateSubmitted’
        </h4>
        <p class="govuk-body">
            The deadline date and the actual date that employers submitted their data.
            Format: dd/mm/yyyy hh:mm.
            Generated by the gender pay gap service.
        </p>

    </div>
</div>
