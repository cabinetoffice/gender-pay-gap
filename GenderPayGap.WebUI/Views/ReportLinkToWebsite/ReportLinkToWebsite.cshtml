@using GenderPayGap.Core.Helpers
@using GenderPayGap.WebUI.Views.Components.StatusMessages
@using GovUkDesignSystem
@using GovUkDesignSystem.GovUkDesignSystemComponents
@model GenderPayGap.WebUI.Models.Report.ReportLinkToWebsiteViewModel

@{
    string encryptedOrganisationId = Encryption.EncryptQuerystring(Model.Organisation.OrganisationId.ToString());
    string formattedReportingYears = ReportingYearsHelper.FormatYearAsReportingPeriod(Model.ReportingYear);

    string editOrReportTitle = Model.IsEditingSubmittedReturn
        ? "Edit your gender pay gap"
        : "Report your gender pay gap";

    ViewBag.Title = $"{editOrReportTitle} - reporting year {formattedReportingYears} - {Model.Organisation.OrganisationName} - Gender pay gap service";
    Layout = "~/Views/GovUkFrontend/GovUkFrontendLayout.cshtml";
}

@section BeforeMain {
    @(await Html.GovUkBackLink(new BackLinkViewModel
    {
        Href = Url.Action("ReportOverview", "ReportOverview", new { encryptedOrganisationId, reportingYear = Model.ReportingYear})
    }))
}


<form method="post" action="@Url.Action("ReportLinkToWebsitePost", "ReportLinkToWebsite", new { encryptedOrganisationId, reportingYear = Model.ReportingYear})">
    
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            @(Html.AntiForgeryToken())
            @{ await Html.RenderPartialAsync("../Components/StatusMessages/StatusMessages", new StatusMessagesViewModel()); }
            @(await Html.GovUkErrorSummary(ViewData.ModelState))
            
            <fieldset class="govuk-fieldset">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
                    <h1 class="govuk-fieldset__heading">
                        Provide a link to your supporting narrative
                    </h1>

                    <h2 class="govuk-heading-m govuk-!-margin-bottom-8 govuk-!-margin-top-4 govuk-!-font-weight-regular">Reporting as @(Model.Organisation.OrganisationName)</h2>
                </legend>
            </fieldset>   
        </div>
    </div>  
    
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <fieldset class="govuk-fieldset">
                @(await Html.GovUkTextAreaFor(
                    m => m.LinkToOrganisationWebsite,
                    rows: 1,
                    labelOptions: new LabelViewModel {Text = "Enter the web address of your supporting narrative (URL)."},
                    hintOptions: new HintViewModel {Text = "This must start with http:// or https://"}
                    ))

                <div class="govuk-inset-text">
                    If you don’t have the URL you can return and add it later.
                    <br/>
                    You can also update your link for any reporting year, if needed.
                </div>

                <p class="govuk-body">
                    Adding a supporting narrative helps anyone reading your gender pay gap report understand your employer’s
                    view of why a gender pay gap is present and what your employer has already done to analyse and close it.
                    Your supporting narrative can signal your commitment to closing your gender pay gap to your employees
                    and anyone else accessing your report.
                </p>

                <p class="govuk-body">
                    <a class="govuk-link" href="https://www.gov.uk/guidance/the-gender-pay-gap-information-employers-must-report#supporting-narrative" target="_blank" rel="noopener">
                        Read more about supporting narratives
                        <span class="govuk-visually-hidden">(opens in a new window)</span>
                    </a>
                </p>
            </fieldset>
            
            @(await Html.GovUkButton(new ButtonViewModel
            {
                Text = "Save and continue",
                Classes = "govuk-!-margin-bottom-6"
            }))
            
            <p class="govuk-body">
                <a class="govuk-link" href="@Url.Action("ManageOrganisationGet", "ManageOrganisations", new {encryptedOrganisationId})">
                    Cancel and return to @(Model.Organisation.OrganisationName)
                </a>
            </p>
        </div>
        @await Html.PartialAsync("~/Views/Submit/RelatedContent.cshtml")
    </div>
    
</form>
